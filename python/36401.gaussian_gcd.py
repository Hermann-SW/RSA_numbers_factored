# pylint: disable=C0103, C3001
#                 invalid-name, unnecessary-lambda-assignment
"""performance benchmark for determining gcd() on 36401-digit real part gaussian integers"""
from time import time
from sys import stderr, argv
from sympy import gcd, I

from RSA_numbers_factored import ggcd


if argv[-1] == "gmpy2":
    from gmpy2 import mpz  # pylint: disable=no-name-in-module

    print("gmpy2")
else:
    mpz = lambda x: x


def R(n):
    """
    36401-digit prime from here:
    https://t5k.org/curios/page.php?number_id=3658
    """
    return (10**n - 1) // 9


L = mpz(34 * R(36400) - 42000040044444004000024 * 10**2264 * R(36400) // R(4550) - 1)

# sqrtm1 determined as pow(2, L//4, L) with gmpy2 in 2315.5s on 2.5GHz i7-11850H
sqrtm1 = mpz(
    11854213320122431594285239927503227694584402398130254935807878134693051240336493001058697055839438560933261843361689963029438094469976698400664597782044185653601533799272325404902734646545003356955950456379771224191826827515310517763483408286966563128045856793247961991545707153639664082529527676393738116180807453090450073633764207974388366124381909629431026820110844804085500691837766544765389238400534823954077752513982236189188049837491946373413860187163923576224451713804684954113577456773419593717549019911190704157849535994929827866092009051912287993666261108139704114619758363693050601027261973331341665620497652464261867369929384468565547260181381339282945871046695507194630256105450255442121425700957222620582812586834639822945218653568583868861250149903042889892337117542327763097367733659534728338001921603596620727988724347459660532336154481950373274965880074887360588203852727595102845372704200856347090500225432336058338236715057082800607421958565967640915957595490791398265183245623614726056937970357563874821466791210676462047151449104405915814848167418061545800611710884291985658661023434619954277711638907644002254142164318262832106374994212287628133023553960532686577645504217847657342083782079584778941070181579410267488574838471291436106290332825256753383857948967676647833613026486148527219059750448438002363867268125758795996405455640562078550886960492834382272755317520542964285210062113783607619151737846413410515157572996189601813817740191299785956385352429412749373957236133329748597716890564139598047015533576811898247135326051437353768641959370712330161412283739305595012533706486506258483481231738558883431043203978292434142982243913538732075663473915843809498618267273914863380293456621133392270195735522617613857602571409406616048475489836340251557479292624587207921908539450771606988722484383262391819283214999879542287888173516518497519881303509033231713070355461584139515023441702579096040379717677480785408313695045577109908040005000741152240778990402155606157855196439268850279028850804150035564244143407309685411217862061919546681758421389708654751091188537973263472083819439556963294924348939304259570502014735572843682027089734018880759468935375488907796256367413929088523427768506856853950429695461818913715470661404098804019643900357822723136179456747060436333104123907622250161758194687387135204378972237695114029348637568009142154226495781294991137912846356294396895158620108438591935651283241248015144538969112663108677801328008983645297811571748575281536480662718124364214306064999435986018939929222480877178528325214162019721631797967315555950400743138465288546800557739482559016429063702992064097688866387160712409611238960332109670171799194854839255112704325667427264782691632572745658568950522172274431420361367874546604425541127311531532975200046938640583670435138645761626894421348079717169109179425124117088189859113112754063886125113151609884046104600352922260529050893322007464163924496495731506003063664594642375312300972282947967844515882397517732398246062672478842031083220644854383771829312701459325315253479429637814100703054601777711482143597726505724671196790831687737499154709826444205602279852903939771193287429332184745252993646308364226865332564317867371666218747865940431897886439020120452755799180366459870807975860170802962583439708817104783730699969070772357426358255952066862098813868548085722292254739291147777621465486986365173649148244642860536000140764060138481376000845899266214262481698216396093888330010833208042373756747759791670955015613821070335476595671201291369444940776638674300426464815456386321042939724124807745547538700500251942289051698875792071781133760471126415911109948953452345833375894800390403928859291240144153132197162360483046768115274205334221709766756633216212501961121524949772980813814193083592445992057919593827215218732565408134120174442075788160685331316000802758330113926705708375740098396988632978906626644368561295706387225188743088390713445791730688683499874387259622098866780209846905553793799108703116914000466011941663302521998911165589985561493550479602344465708081438534757406519359266724299546625188127305709521407197657962250530548573100089261579057592495576522328525337178629348884395824707120388603952961154574415981205798545369415261122332821132800683269413591426772440989041520162594592699014512850272608859816214778945307108040532903173705205255133275025461552083040005944072568291394261468898748788413687961632324392371776550800307025860828787700938557244477127501430310851970251827736236908739344436441120844974454823761358965185613516233792560841173545561203092674007279032974714370848071609930033358498122179946937067435661818168239807063392667459680199972209170268859697788592064849177806584564108244942937083160224225930258993984166252271219205423147825052423260948634301526280624812885508980774844979816278397417843214596411790213284571221285186210941379034560466754522815972549648886944881813001482753944878254270468967143029149873082819618875922833727018236068800133616756820178253215449138778424974322237629983321567801869398494174068228787258691419826227656203975249895860590080631575898497206930586015195110095282888720840901252543975848432182499300218717943589972818185459639901025759321525178149233854629863729884668349117402285793806573506681616761289594500038233717105668371527246347758218754170505309957032266446153684414429548445668000636629386434279180861717506149996231014736697806740462907180726580589162612145089792172041897989280531069746903668609841963245167811987948762791274419078091223972274617858759653592012423600219700261736572472845639541193776510619052078501170859593115765994049336266026662382173755840669430958049932258630614590079680542054760984371973216509513518854285291292150355172397153440141690051858245509985505098511520605488485828165134547367788504969702787633385699116474649544688867402067159079604859305516849965582271865164572782553481700163101602855188979433946990745908125483470185408442912246819148166531194218021072373498026852960467334218931440334202732356515412832860327476567717429463760296870351288919374303868774523704875990698214066179323658267479534142090705179390955500573026807220792005949012960922250362158145781399650865447750622852695258776783361907428721602675825162321280875672705006057337836369529489826742524848066437332961633884000824191102345011861385559662812290808624410270546936825730558793963108396609863699271623503070053838146883434655961152450320327694547873109238690310321620346006560628505944904642334501337273146881044892693889801214554591106980183610223059573683872991416586577907270974315932754108357600459969073113166969872961070080992572429848495723950654992545560324453613219865036677663741447304540331638038171436773882331352628560718402930295029574443488760344564922648262323877385516343646236920202881451243290986502429364267659682239519779653967390100409077538767539462660621971619027966187146611427390419040008412379160587967642978888559266488737058178375717682937436749598152977898814657113629712647494369125775094129989249566431437703877785698729437125838335859893390104733356388108259978239272742752373470577535144719068619639470615638602951254642489830311338927471574029707686304043897708118144178205311644164474787661547309406437555510858250167138539859890297711891087557836345382215814890344463929482368036741646215579440642442901836946554245813554090263777171386398930789529623230627817041589888430530096840720064530011033556033212245005574948784513749595062457966227868715913949158818915450328207117622276943371574586171765132706177534242223326657639780572345534389515841010041942948587306641530490667771100918713662182019392150847549513407758272751342692658639211429625262663155901146642357159375165630335526012559103842713605182743058846240151596203673662393598169899702358409995070064715969895626476259258210316398848191037237782367974335444053677599424597492457880520952777815894259200262817334735136760396487275853863509489525016626493259773479990261918578276227805266791927035131353756953124266502619556532924600173027037941929328640187271091282955039128365492566806954866360770598422259488057631728250450993033648851975630745226894285805598271938857290009230446486113745737978634895749132330799426292488118778362228539418025128390859940365539873163575511857384315419905101998349842524382957493217120643937362456842328535379353713912661161244548790071540546300594264266478544453486533159387882677936112583369238402688264432108382992519384422019305075969738224150508408103900884054974424899910004572490920956822400440150467149848407952557051110777486861679501558296593734657469931092329358863529759148637438384012526951545422513885307576589917134855836421294068637776950654514656173983543318788149741562581213762076402885488869152238140521169076399628887970654308624890325668284199206504147891696282459734940907433042559813993741925234821432262498834858577455768117635273463436261068910671062712062666122916462614810630545874049433934048286820776557432254188195208769814667557791266695891209260513171992249120119075639311223548429643018353060628502336421900691397476675907081419626928326935980904768225997360276190814709838130572583809961252868818307546096847078729742413745912224117920389637229129231452614060998470915950624331681052626388279648735955432805456651761034131402801010306360902992468839757573158585339383407387339579712949926653665442548085060384764106526857046865262707771362838621394170233031986379969102292210347486255355948309716277841243724633692492124512747676156127959079461105302067153282178519391184731987455010356636274548230634273636264505732700175320661149210451766635627373929015523771436123739187400070565581624749357870594081707925590572582098733984288706720725392578564394017536377799043819599994795527721010430269657976203852324561468680050596695836954308824632347756619408964941986228132903555875881809547152045659594189871500985378317534678111296853224660244979195252367423426496696610853135275107261583859341760949138517808178421705437922600948035849308735272920613000578828752225963389532706819546284133488121486960924293937832037330851628563758235985765260253066475748466571306033229802465838328138119753410910274703860061563626868896572120167542764125248496410462603845522752801410207377752643702163430043407931645837484451980859263098313537317749036135374364600343288813495707857730051137485912296875418689937412228586248909106684708724823236940506977454817319918125300207293533729351572843604592600396231742908239891851127859898582946808901543282431501858188808584026748093735176781010851694971540808228927619523519022711279079396503077877352663121551363936620460828501705917576602537241460071417667964619890362042884209103750274392342801141254163263754967403137751167976120642078277446406869847047023533514838955506520213236792399184030055782079018464461935491178085201820910894582832497043171629577137192735452034135906080839173644799970327605889616357443303944689862955211919053339978802160493368915738152569262290921618778202769810182938520734768747454979554728585640603057662381212659669490369015978794194722144424776753616651471478264136484382276226070090863060201192692838771729006948694520411033547203852361090269516666174613868042578148392669521047173656755509195520630822686169023993914486789177343600420404195309572506346004362993906731376006395494297144469044209475882724007120707743665543135273478375559642266824926715415585382986343778829081965166616446498733887874890202994258658152434124094592574298709070990229197120835698325631296033299766056738402836301876246072353179094246775741880628686641686190086875985562228211719079311530689918016401380609188504891944685780503965567852918802998092790434971897486411511401773036263316034497447857145766917149220507600096220684721758255546787248688724345235324718949792741181979052949546509243708303896749852362254287112500706673566680028144316018053455199828567413850847108669914107582775614793443442181152602568269181527411309815131776726764225180273670535219600947837343142338284257998643797830609138310970219482526973508130320900306848219035180730736662474403153119929829799990214675777683920749734023437473476219814527926852889457097371438686595205479853208960649524677605737745248832220394170766249683059392685997807493055058949637142052515582913908857091431386586904786640814193827233986857709529129298429968474897037509242805607890000849526728262952901465348661280647135723893126930389716282586430881229916774796274143312235859195846721499613067616754322246841833397515126283853558154273879843789781744430126049892425530367286123718105625921965903282399759493174727888905628444415248184587476628041564579651703260866144521543250140590419979274963463451805253006711584686108412631297960884755810991367061909061092123195451877241109952618299967930581023243041470611449704858476070655556796121035073777093456161731794188285207576860770752944663551404645843608629769911075685953448996737677212032675458745860584745283413750911784893503172358101421646726977377331623902532078565897307145095689932127119733604695640317427984136517361775642006847891552818410743368569135838304311381272594927277327145781655074614911691396482786844461236610871833096978483341918675113855277662479393775651047116158844531738907330661950199961153068518223157677202787432441358226976465821270295609667562111578217309616190984201517681460634770346726395540996014419476570199545650291707253517822319619989763021429601260342274694125671657035777271711416876029983821142488044522306546827053615991668369687625189852682579823283933449414620569279367595061054408430583215292554819238979004643138104989960496410008005716527021884539316562948129721753888637567522082533234937382527055439284332129752073937969278786124683504458554987268600379859716081681934388767150744631369405468184951620653210100325821687397505059485662330801927545081884053255044625191624811472847254711152711635646997725787539999740329751638572015962439922996641842089969575442871695027305223258567639678983420275008583629120635319228191643085273292909372319406118192489126070314386625683709089726750236737642436411956577328961234049066030161325154468111697373614928111431129643588251605325380190849417350784263644304937611755874549243818083982311243456202250726677035376465257328024642936667029493884319176311076545219261616645044122780836044980804709997356846239233900802656578213624197710505216704237104735432549097004112480911479320591354833683698867360381943414200237346265286499727260382128720188118488013373499769241707650211040050997570144434951309603223585569744629919004268583843634259204009914283597671960840837120058999264159077068343638071733185416044219815024044890274265636853279200889959440701304656291578903203739495890277648402009065973729682836738811854783948551189552956240633710757884552319677497442414852952679862198857143157695270449562861248985119920007114839185411929231189061754935840702729366268807309393547115452086067438404480968106645108402540851246387180780498750710778926146723899701793315789137491525745016142903113573214756197213681768977952505833072902396228040545142934717603158655498316721535855816896720719037080792935498353330562147340482311534575857790042175854188270068548700780854996020878473906300344705094840518715282836039764324254342285482926348463965331657973469998572136641201631477235052208547446623907968814729345997480172772474051064984364843200908240380145470628008259375433909288484767855809134832541624387092852057975880552652418456594412231128251329283749200112709828214757004308686683126303241850748962333463344885219417567826561791948993413797653655616419789658026342086492949883612007968382122573229778927635503388171143667874854380800271193034068215754539184590522644625693802045630856173128578111632179267258952432824766709742966421543544843099560159689248651443476632576412500067487864142893937242186087453363669342662798858829661750071150607888248814280449291528673883321410899290857856324727993853514381552985026660021053065551689866676443032985384625258245419168118422526517804128955488585974449933463315831854758991138842151459335961125117653294273150160090494284777786019061092370677509722101979399526343155661570893755492873176040216736241332863252735674372940919235905191862128618622708896947284210983679039257172409371459283871195010161297272420599383079704143646464108109165361313425145400127795604876678672193033316238516094274845462278710739818776889598492364514221298695074970399592414371545597322374134057215739550161584352761157611146982095264150575144439783199690652511871636771793646458792975805122914720726298827498034958034149840745246136004221404780619852848455412098847260854008262179661400290624649068713109053366262844770428345202795387755743970620825810071191935690172327954414041397030104562368834926543822822964156042049643842821597534559736050449471535124084102096580802173501587534490397860686218495621403498727031135676254152217916656540191840763581077303726196989815585796834065212688843118147950624265625448133031915537720244093330430804119784947406683988628445102445681831842943257547285934272713672862223759898198408899252329482476514493849332659079489978668609315472492727712736093501991096557314039141959597210820099751523974054919178667023781277357979768984696804420281252605170970421617268323760211160609022478577127620730513271968394751389604613497936446415174454464078450172443291138378803384422290949808094211097466385753519174672491591149732901838428988273812590437102659385875221203519922884294218140165971693464448482103898239760702799887518330351982367592331147313012604595747586679216527955368414089437267561260560438394167943746173850323015521748736731457375016388471534354763899411001650491754212249158591899039204946413681060182069614461272038254352067818103008851968891943163508052792908932579043329731651558644111310351069069387089023798419696478957270123234768110072036533684281012338178729836185543804487491841834335789150511231754257817963224137582086221211855066637328085362767188269805770594432475279071962308643681957389635512272904911598524045496270419017590329892125846938343066273580905944818893397294782432157381762613954271909593312771361976681868987523028198296140580655254347496791269142368066918014775386005486647053195176883688829670792432608717281034828244821641151957050864967164689215781547259407181316738420802686569897753129972419375487800339532849309570327134462626508473358762025747483901871591565039598930259194704359536493026052918841974932319473332322231658211112745287818617580016699506734327488142278498534203394616444767414964359918477779879128332770648400803421715930818839734029614318195013839598338163657529805392056343466715758804681122002530440343162800903142096237964799779715761818713222352445308881762285154087990784354979302153229612640602797817291538227894932718798107572251504118271128695610805734075968124252157455259596001805173106311738625366132553608634128293516906487904323512932080970721508404501015024627721572631599797523609589038080072332399550659411298971967836425026347385762535445318723051744653580299877447675156591660970485066813916410357646521455495991593466563783185325692622294556354967565253078893601502495024574749657330505173992274945368377683434397298261651796213384864269876193266991971456303468599120033196457876442186999553700693477838630241296398668822833103758146763336374608754268994867484175580155951563033720656852360770198366469633106186929713563835431726326258998750159994303760409963928345338108638200387193942275074188033364580962896790320260686562690004546754345968779713308374486225981956434114950928069254364088526857159078594919356805624881428585819028883253918171823991517195400152163440444831112025180213790643894479089625034193422177297965420532127460494002930896432808394264225244256120464072636788207775030159113120933248534616977873639007175635874083342401655459640761405723058961817349402741548554299655120156551495853402158085369177957450516555005312866887909956493074816288070662966770825126400620478584934389610430763165735136068124755814645449396140830990678523532529147644211951770537206936911530774247675476313628914459331434812781150833481420025699975665535440568507918655011689971970664615266404487728663470011245773316181356403993550709258852438812032107475960747488922092031457470599166295183424379549613273277652486335560257067265898686658390252020876112920098394215154027307485881312097636904482635808197982646705906213049964600364025245481725801031916690807977608050542592439670439563820807543262303387359391767503732565162211211209776683241454752870454334506425908111544874373837739747749998324077496106991379691668925527835883915079538042302131115045461166238759575070890076685838299992555093244798928904675112365052123417667119951043825620316070312261877112662496357503010702197370259706364446053623866517180675886732070202070032783407312677132646941302307760696145884447019827392563902349130073347761583256246709331770127207448001234831853230931328432199609305693750205624400122392989222111973776613054126938054732343007862122845102399870846907927327379801546647062265983690157007752229705831331412784501913035949114974288330840542883770936127384621952124320794075134380347205261143124694360214549087717190672890284111137575751807222878733242282823415978197336899663724577960813845836299013411933846858221175664477057253375671450037152091019726851960796533522487576880789297274898362165904550821519810736490535409611217488098112391012340878285801482066252807474969994471765048681986612807417467039675377689440531602939574284733116660092367025911627836669391793633594059766379286584952269530717602261259266698928011764662250919287133616124746662499920439811036117510849534940578394240986856368523822706655648878898530631269022894731762175618216314029443492010928216720398830793359012177517193626224826634807739417090634035616204158823372698147011891240667695710280358102103495209418373581071254801041981570263746215951133320252406449982933875627732023253327125938710643460708842881596540210526028411564591638832683115216513315399306894506026326379476256357543930901308923124145494628154375572792183875184121589116958527791249941715970652214213676020693653010658363016078574287270527688704047174727633518480406750680701350717334469422054576564739918597258022762131598352053681637508093296005088900144477932651106176954924421721226892953955256088872751907213139385650139168033780121619153970538569638882192605543998145753704949038659365363219076475490675333658097825848194793858408984582038047931567447303405747214795153158518739296092796550253328376643632200638634620462249077204478683591057751052315913755748238371133545467785483102098067243903965270248065114948812068964090117711679082192799457911993802156129477639388368589853408120775037913655977796096180333016706805551838714887160292488966649799913387221106184212677381055534322110000154018756502432025269065781396792833967070918582358115554397357497752433018340639633464167033060726645534557836838770881535584078077325413670336285009711501134878128693785007482905734721698630046335870920543390025903574965251724334881134413147173698176262652827159482131176301577542285282636726040740148869775247870069678161660795095055487899989799026356356620316860615274286738434757246387250162824801452738773688049683215629337145250048181455668241359688024742939497986084995183468925118208656611927817227378034134512063700592941668582596645912952046817455962866866531290756066907153332827095829679962663664360258467141872540442683263923249910304520650014386290023973010990189368357268690612364464509028490936978831707751862338782956118514108975317582141534633319848171598681728187635830404585785440781783877152105004149260447269660110153065911114259352116622638002917170960019791086098253420498429967672704568514007270267524014483365137466078579879800661634399882426625557329074464119374866062522801713376146792054305989688625560024126479813791345072213609134775744450479278918815475646138606598827834048469685235076845695126361482637617390819125218819711270994035292217725241622179196517896712366819944401495508409422718793352967938375449479607216374934846205087240571483532300428235373216381832007332507357255586791132344025345243279535625267489876170740393611620637452862974035083920563284432366137168990321253382521992777837104304227900354018518292218024304249884703259606862873347027926467470598318304292831804531719747363634922162880209627721785777261378948875366922396803790375706268690911941019822066909798540840607859522183183851912858431981588974774573777865116911008893886305769402423954982966075500796877821901447257100348013152826040932137279449199596165124038019628711216628755013177982831698211719052757172741335245233113594325502276630839466516969588829546181108972953277031373118192845902683972306715160107835322540503081465654741551263136305656355126760943404713893631643894728262124903514387627582141598406764521777536810674603107467584813859936840643902448289802463338216186659403412289929102848222064833267861867763411189948440368969446072158927601311766940567663088786927006460597467810723841050852830002484431061272022469493831623408923165592482122584649892024412764131535863991663334599454020763726575963187611681304812307869107614434703411042877335441244171422491344145474257932076297846639335163651954262118378101710766840062630875708698627350558367337491210827787786021010703954879357765095675886142391220589012403153198248390580612597066299932926932061354276704262214293840332881927825281359596898754420773087722751151410966180617798654454305570931220485985134473459319554514772113210045560416823650967741683832617058423331672407244681173559324271627204307964639338181779017946422798048481302251941014458960841247531942929071870717187741739229635650520424283809980147542595781481766112929058771337503931073718390622339600109079518052506768554668483442464887504970107441811111298267339014657099918871894645679933595315828720948491870385318005753521223372130816367324573333700118936919189670557736449757661969107827421781557653429087441352897085336949087235081345531513470424689047166032484553958322326697525332477259740742696100092302950352369175151791812769938959850964049345517814177254364621170069233827439302341110699654900354335577184813327762251141073213872165033097612943375515781248210600665621819453792732108342455689623853634928416285269117186644704191904042547642122804985778060452728318236991413179776260224981924996429688495373802111420162258800357218687228100460442660534952134998441914824369680639469501968512870900144191945731902986526524335134985548531290324453464720205894549631941032300415540458209699575511662977303997739803114756544484219336801773988708672894794326021157732256162148024555064917630890522156282187215090273480004792442922042166403202906300264839675174441122077885574451699159172690016611513371068589853636871095609978231728619714313684277536026202887262756354745950559790198052094315695648466030735189191623380147829414547360406718277788880405429837846288081847586464660276673656965117866308450221570549621096054023070397479965223128354032543615490231857204098925470338696327696731961274867847157160192442292509815074901887567690648427986916452721498133716256455284581947523600377451362222852447690321082492818708713879684062012242793024228678346198280425536912883729577035289818325637338768214973606774226508747700708992220924414409891288269051363737630671066262580445115327263297535041594579328725813530176415326122995586182303435435135545264267146539836922302525648159411328236314645493143356228319182249183908283448580823773836414891235323401243066225311243181420338933765276201373268180646885817986627318011042573107670763419278504040031984972646056239282061095977279459989883755628649391348716910595090417126401885548280279825667181573719628246088317662411083555244402781703824227733498719781806255131328358759417586837424369518122288600293661950897533169977494018402083754526409292501471882380910225864854773866845255640881644081410907164512275214960063376911617927944597699715459666648448355011364110108731537293278425296578426892113143208594396468298654723340271518306860740094108685679166652736385316605964516885566733906525977955527502422240453730395967227672611470345588884848917662682808662128636847082010815722581498105203706369004472926618029640313000661416856875469316784171839845872800427799187017689388692189898787303450146674634267177896502512838733318744773900434756955459400880203386238504305049306573789400545714766137732045224816149691066292303032147800063686324387702262225025229141747262436499035370020305364328074394090888945787429864899227427915112501791463174901476355543970645236056859209082780637983624616945487221847478429027544222564741365779032800393735632756240108310728040290317516891851992482965032739659335638018620424710841197055089917281057680202310273318860465981640920155555209908440360256242276494965620915645884627393658008264488537882311170535171836267815713294782998153404659292785946393355418213982018443002883081698259384986982697360400638083633783520508203996825333641831173640014922330534783067088657754361200637390075924644531437174754945402452000002485452554402273989778314102807856792686108401964312882465149640856256367196283332126058276625214056126202782374726819830428655038983399844645830517855089784055704454629839603522880390580141036951491823978628883132772354611062190458326024609713395432001990054993824448929841418071075137400052593211460145327120861491233913344042597277298102174701272720146112126557063769927315238502478712389093554673916344230415270876498152456366849092517479409812204934316170191161372987778650000833130655071021765513462621497262755652012116644661723013287536474832496628915827089361012776920826394865032010441372166463964809255591376339520154466403046324088180785675109122632471955794320511413885258491136433773019247006623141543478231174765565002805414226121114987403129474394755243924624666915286432833344917623649240472331956244971389870502990196673240915515195528157561677531361428859227726860755864373326515975912312683587117697150789187679136396843888567152469460330127547341259504895289349080337565858330973075097915756936518952988142079112565333680519254969978761532750208405022426161652966631321690481008635571405737782048355857145994896956073659068314809182092011538863795883487463991172375693418146005432543297882569513048675785629239798820303184382408233528408804185758351089962008452514259762346554089161765281795606953927547268612139906015501481746665987530321390499668643645103143073189745266689036976995428523434151407738863569412243409335614023179833769124582530792131248045606992191683185980484395684823302727707480432026860467021187332303223407783814305812674351947775800941825617972641591301597940933879766704903474543249747909698312465563669745370934712589568105991042634473592734230675883025860435678217240678166037727343130998842343382545023457059502914935227298081131456192255570035383205422842106442686233932038967239358586176448896930797682700540562088051798018074966792650178787383100804867262947310379274711688444276721773213231875477599105545585475653678416462652429369976643020679646472099570500259271547384459009005211658827466759452892250595025293758947986269710594509742380398201616443621545152749281754103985341265861382352607894731244774533840392102384860152889143269277293443723404865278505317874356420352828451276768392116808563663083530328811720575799218861158117498548038939753352183038481488064743524598598390406355833200575649574178701454769028828527369707390107827873423683863817133329370219911516085943587761969643010991017886627508933661285314878341439625551371662193264638766767827249907154214087814115334774381090120562171037923525788981368999801701995162739390118970192637421283662296898457924618239256550560106817185541629195518169908761119950103696156410118891735064762345803224439069738929606139499785953433669441523127346528260541717114317608779901564806259125763801036391350108241617101008599072842942448932835063770800843856499486248753129037810426532646009498128073535192646074115812825744263159487786030691238054795181495323976739847599684191354239954625998193686516521942087838483309793762619900817102007718697811726318444056755031793950277488416158131245230392057977123574733386358044107124858129079961390377995929952644835697941134853787397933522610596638659275774446468129246404260080629412006266436843129507181981859992044867977328973393603493432731651185059351280782029998042528626825915405628101702082404446673436140219297706365879946595110483368803986550821318845646825294526576278646148232412148894422552034146747272153361036978762137352187191349147483437258402529468252720922368060065774038710994027705757602711669411012017141763954022973039416489925477481914712674273676711273835168943062041509539929265594838730250525295295730562174578409070301074454422589134979784123152066140412110053249851425428109316350081377807600612029549029753069941184035928955297010557747856756834561976136493610386813059496450298001255554185173596475915585115986683153507818388346446061452217399287375619906085609268283064870795484661774477719052289618306076625128719231740681332286112084082935564684790592677284212788692958866107597338713224474165521345276320638734539896121504824226526083089765493490649669642134807478154564630071081051063792574751093041029058307812131355538562073538242389609635588131297013522011732078857963146380612579798528734548909367830790573583156687250583935253487007005450516744060244259811067129736392821674579595027706713246593313733207608042146438952830322262853610641587358825577291298521785288988241946622149010768982263664330454176936031038618738219794997476475547369393717797017069515539403807556518521309001479067412724208790762874495625215512882836471656937820887509999522578618980186855865612524175154025668347065675798600650823598389934197553329061317041455276204367344778382959637109513163973582368559873125954240262143211601657380848142518349549428455768236929531272725734499707187090730818392379682247686274958094126341505492634386806561138977290311722981945201866349091133188107517238431310748044735072431042517804556011281638413623094067831911610283387317727614967014850604331643298375956674722406176212119895313457044924879025423153007221773659637556886451519440446003822474443800348508240701917300307972284624434292110496689755094843973425598172487092234084230972903091304404073890601076641892155269488713476726638461486504135520147294099974276888694874996609674861226900900868725676706233436734902390861464929795641438891466797211425803556601696447903615785808325599453443815491109255916358588833489050599545046893428189831059354703943438415601581975540675162721717726292560617673801821624769331002989809247723013938086417825386694912338943067833639509868291605770795154464091411629567489273238020692216194330711784335010366139672253680427123385781650455743957979499664125390300208110883737891145462994678926225950602116957091121681913502985201412473933778673592219015247480402369593399893244579316860856468480017464942927189734409952293965455049642410185736610259243121102114710244696763554960481660073034939643181387587629974108674466632306507420101758921729391072206101321043337610479081485205655861669193949223765747085543808721926147749638070192014514246838803990935626495607875583813337758909909134224954471671697614092991691776510490311844393647039368753982939371119108237057432057021796784301162912449770718833123157432296989583807753225720076727382912052325240527293043677461369846754231183246557216147659337903574807735270460389066179173971216663442890198729588187761323960851574895404928217596531857252248967783473096237295466223455734743674003261694740200108682568567884710818228000284906419676398076340117535173049214803516520972161652576561015002946252475548614302945988252591968533823096136979373716451182163728984800080795088147478154442009215217498143353180077598628428430423072727686102655900688015445049470654500364112173099422723601590341494587682447330136822447947051964606065072291305934488698997413489071524961780425227487967551991421467558418395651208495439795731179530468047087493495630003230220874860822968452386898061216808384860472680405145626888369139444860363046335008365520735026501656513282061894852460092433893878072582935560108436717300398049939279302237142305557636700181631687460970038614678905519463723218764325633522135458686279382580947713402010086163251825099012616702559336179229782564808675396362218637768
)

assert pow(sqrtm1, 2, L) == L - 1

start = time()
t = ggcd((L, 0), (sqrtm1, 1))
mid = time()
t2 = gcd(L, sqrtm1 + I)
end = time()
print("ggcd((L, 0), (sqrtm1, 1)):", str(mid - start) + "s", file=stderr)
assert t[0] ** 2 + t[1] ** 2 == L
print("gcd(L, sqrtm1 + I):", str(end - mid) + "s", file=stderr)
x, y = t2.as_real_imag()
assert x**2 + y**2 == L
