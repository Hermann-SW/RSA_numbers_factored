readvec("RSA_numbers_factored.gp");

p = (10^10000 - 1) \ 3 - 10^6333;

\\ sqrtm1 determined as pow(2, p//4, p) with gmpy2 in 3.8s on 2.5GHz i7-11850H
sqrtm1 = 1693366436544437417075416368608381933800914042614814475683286736444595790437888503903804981898843496159273952651872411931856149172684932390989217107268560268671820844552114031149736055859166620671042293394314812123742249975866967301493378004164694381314663151892992017717972211741058487891652168051181176101728772920680777390606100760638054130405412930691011476705995013095741375235774892891692405638643788076904795593438740519354715054515742265683197410811533564983198510696979502243955156751960067559020569633969612545216722191507698098874650002145316639425953566562618800690282671915586811501167390747624832648711466579740364010017179688708346105440200642259778416668735301218162647524672782457506595443991134299910723771890673395238483786228773066013268362219588094455838717626195129649595500067735845058087375465240607982787696526272396485287121481486524941773302893574032508266661642846689967334313055565626639904602601703868987207535205399571840192207229663260087527959809932603323080422379672531490582104020484430064725276102296586581734109300488749500478650682758372531589814177197862232953954271809727284463831524813932785571184774904841710623569339286390951165993322410954089519816948204347663073296680745351435803818305672799451947256276539060849968925752970635423011392880777997876401604073230965894892084325037815594554537695578206233011581715684236684608619265806907995767140394736275908157463659920523407349436061324351826737360651141513580891642420397648392464191694383865756875134351031038775756776052238618680293685231482595234642364080726428880983414990285750821370304897211073227265777113493115280284612808872173171094167973130642544322611670591360405818968840228392086320057340662921532943769707264931746361114160859912072361666255185349039583833945154805135530280065886370599344308573893695681305539587260767369330740764565098206568390325896352875859205547064504969700628530719647582491069928423352761551313590463161653950947258974174908461679803601946763880186718559854964527121934675619964092911137525269496635246003967412610679220850231817595901006912656030243953894128340947451414346901308783582836603857471578078324135993153915348656120344881630916245354596017494653749479494941874607615123434899794539046834917285695663321532020206076896341763607191504655302113653695897642588856760555434584114525523557363671238884091150403203267920228474286062719831293941861841901894423244778286415486306088608437318049542111298268055811580458229911392980343985123662561527179362289885096721758510528040216421133883430226539413954037716961964802616929501542519141955566148855604323729853781346389294916062197357851832547954756229550226402687979595237755945001496244759959752047735837841357856451949136448693777779258364093225085075999768653120598927797601422712108816899319267502771063272366751454317262633303905244883583804517378607352555671374976006383858290333378948714527395756495999518746270516122083892102366450588582445052553425933356935593944551644562190914414885421492133675058600723048567410870265348853349646330593648599396816725502170416060853526332733336459941767524010149620302079614818049403419817532032313142941739738921706073579088732573615996279619683069256047342860431107306078225848479754023953919048601170459927835828725803148579037350553312740903495442916024324549473216050733079765889886124091098719017696796894634246251462779269231834771442775363515709751709089134928869687328870763170769406384788042182024973785044113337145848252116375539551298312786883587202979506066303940739371999584447620263308293858936143546575416087844812914012055569556637491988384062012593938378335195327010905842790918538859393535088386457566005067160253241320794126990534784870314093512492001662184905621156302147780061518717912464432007345103403420089882895114911816967723278781865658765687923640197854677407213203035034227498554101176926614536134168085178417858062857549979057537506039384576928624775604367726242649198734381770478307991367434742959408973974128841225482373504817004055481055414761691891097555145811502433047444033812882532537676404110972535775388975894535018570607613617237355447910088476231436241091930146534598547854985883757847865589548038476318333911135536058121220560532263176777300227041336667106561569674432774771962354858368133134999529143968701875631237680292218914347087742049870523072167026873627792538150745563228954822389754321123869540311335468096288338166230086738959306905515489294865379314093293212794709654238719787955565958707049257420353515698890753209219199544229993377169019256488879377049956725675567404308607775841598463032064575780565913197928209112901449567828333909478907925687630206769257631652666649509318041172465188847384629266350316627944506490407742890764779671397408780498417186641651020752717085586524470534966128329844977475437953491795882852217200913766122768908136314934744096839870958526498969854105453551419906397534522537942933155914471053880314455000672395321835665690072450674951121422071296076101953435319209562730945099568944372310364133353231323162932036790618366810344288551682584130538366817602927983258778824897074574172455713924617382070927027684105469005863815876000778560473142242813377934931370769127880909560114830437922184430703227676895289291892814713929242542769720987915035386289571307563691819781853871286819604944707842393346812261487171682375986153488315001300526521268991749904156626448970457010626432135303722956376038133511729437399332746299158670971630194934669376044624276928121587046646407533615357258143290439932697807848252509831914542152097497667464772039262110573452801047180336306286626530707965517953725340927882891385153557347322159942597820211767861384885606211201570443767902004209111844480326471423732609402939753583429895788190168492176651613262355333508863858002403069880115646046865763599586297488071917404718625342566422282698144223295550005075551951399040351093725220802435016507708472178376265409872614861244139934148233935636898980887414893026800478481158188486623903466886060422907679568544418433786081248179647014031832390267073180295933656707359140513590480702927542499504786068024789012586212522928670230272167734869136383631274503432326301170394744141277632317810769444929110890945072180565603944504687005594948568046193601947620940207905606925791917593008950232893984018783701336728210729701421996005965725566062184622945136970834816536005456024840719128752789244970837682848894934541503250278303749222665341279644180649487190352926844662045786689407255181710276712147548223890889159010561354335259201571247451127096810556290392085241294164413521187916183289555925314990998209613918824345409089425533299557329849392426556856637284578122891824690654440501837060547453944021096893445020465461197171454545446932131721392965839031451814217227060793953694690287662304647298553808030915971864929405882823254404445477656240189468101180231504024327935329308664689106177173224741331138227424309266633401090470814541819889549707249930862978949977604069729679586074955584569026777114174057447350173060067844477133114927723656099818405346294037593632345457215874384518437093572344121114118613497235349658662107875055877758154590247714099856436093806096816583051633319797992179462448276304157867090401857819078710012049437078274878940373042336774395367904142376862606063569285291169800213243131774945585287012220516106251865844268872688767462778831517008284762998159587687221578742324569883890604347017120567635141375429339962283962960185147948903793805102001489928790504006784346100081674905947585200374076999902877560229425734275371123653115884406151122719404931146174820860765994836214985720259668331587377007487020459747776097401040889175585417687353712747209718087638073321179315026817169184242999773737611335908415836681442093991263009543430510485999720130072327755314897664332650834144656965921780833021381502046134010901077312634737565331704052396212084250073983251635141766000242500556129862670071491639254596941029860899194784824855246705804148872924230051410663734924447104387485326277684300986939811130280499718208814917988330379561458395931518931189224629655046251275354660654971085876045662967829315731124994542443619258480990259120157922452459091206482081912580182908286787517036669430378893899941555056981133492782499424151797267467735921831476735113877040639637463007815732459495073986065168473800603843069767795005558461378532497374922605523754988751999456211632398564860805104357154495015639277237981469810494968575654472005580743478358518905586964553248146369971195825584588825980827156198388930108274521325399269393444156374679357012605227940232092767978503510606207197279368444227277805786044978004654418070723287318642210454256440953080403631648592721324795592445561892649621261618120789201854972116860747229200251489378533708097717036140681628398956002618611101591778277685895201494826322411181908260216604171724152459555481745675391155676242346477067539102191580526995235327403911257417228457625044131327096502682459353243612053383146324340301243842441254594012595446366308719970890793683357217668656126046547443117508741098954185907743607286004934850243779674993145962873630127203889910884843505341997643110206940621102754470560752169927596043967008901635880110268950618789464324405328721368572278217245716459445118057630502334677709911681227100568022530158685895052174002227744799875973551561508328134306372020573275145868255570135288168784542721255867413181609027955271242968404449416320678637527127476324277112979929277898738345035837119121296785615481075223862817041105190735391806004069369687907783108146898266731321719194319559355835004243057554218211068597523581769248714373498696009895574251455435077236432681957179623784949939706925962752557831909667411500869315001276190876415387164944051113299272222431581173583386216661528178572257999861361435483437051476911861711145686167958534114699742827819181266152059123135193597830563613435819374617996109700523701947251209286222594704433827683845163181373380543656843058957032702041060924840441654473699203122;

assert(Mod(sqrtm1^2, p) == Mod(p - 1, p), "sqrtm1", "not");

g = gcd(p, sqrtm1 + I);
##
assert(real(g)^2 + imag(g)^2 == p, "g", "not sum of squares");

[x,y] = ggcd([p, 0], [sqrtm1, 1]);
##
assert(x^2 + y^2 == p, "x,y", "not sum of squares");
